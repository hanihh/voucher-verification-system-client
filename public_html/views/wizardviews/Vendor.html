<!DOCTYPE html>


    <div class="portlet-body form">
        <form action="#" class="form-horizontal form-bordered">
            <div class="form-body">  


                <div class="form-group">
                    <label class="control-label col-md-3">Vendor</label>
                    <div class="col-md-4">
                        <select class="form-control input-medium select2me" data-placeholder="Select..." ng-model='vendor_mobile.vendor_id' ng-options='vendorItem.id as vendorItem.en_name for vendorItem in vendorItems' required>
                            <option value=""  ng-hide="vendor_mobile.vendor_id">Select...</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-3 control-label">Phones</label>
                    <div class="col-sm-4">
                        <div class="input-group" id="phoneNumValidation">
                            <span class="input-group-addon">
                                <i class="fa fa-search"></i>
                            </span>
                            <input type="text" id="typeahead_imei" class="form-control" />       
                        </div>
                        <p class="help-block">
                            <code>E.g:</code>
                        </p>
                    </div>
                </div>


                <div class="form-group">
                    <label class="control-label col-md-3">Chosen Phones</label>
                    <div class="col-md-6">
                        <input id="tagsChosen" type="text" class="form-control tags medium" ng-model='chosenPhones' value=""/>
                    </div>
                </div>

                <div class="form-group" style="float: right">
                    <button style="width:100px" type="button" class="btn red"><i class="fa fa-times"></i> Cancel</button>
                    <button  style="width:100px" type="button" class="btn green" ng-click="Save(vendor_mobile)"><i class="fa fa-floppy-o"></i> Save</button>
                </div>
            </div>   
        </form>
    </div>


<!-- Tags related PLUGINS -->
<script src="include/theme/metronic/admin/pages/scripts/components-form-tools.js"></script>
<script src="include/theme/metronic/global/plugins/jquery-tags-input/jquery.tagsinput.min.js" type="text/javascript"></script>
<!-- END PLUGINS -->   

<!-- Windows8 Notification PLUGINS -->
<script src="include/theme/metronic/admin/pages/scripts/ui-notific8.js"></script>
<script src="include/theme/metronic/global/plugins/jquery-notific8/jquery.notific8.min.js" type="text/javascript" ></script>
<!-- END PLUGINS --> 
<script>
    
    var tagsNum = 0;
    
    jQuery(document).ready(function () {
        Metronic.init(); // init metronic core components
        ComponentsFormTools.init();
             
               
        $("#tagsChosen").tagsInput({   
            'minChars' : 0,
            'interactive': false,
            'onRemoveTag':function(data){ tagsNum--;},
            'onAddTag':function(data){ tagsNum++;}
        });
                      
    });



    function InitImeiTypeahead(phones, addMoreThanOne) {
        // constructs the suggestion engine
        var phones = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            // `phones` is an array of phone names defined in "The Basics"
            local: $.map(phones, function (phone) {
                return {value: phone.imei};
            })
        });

        // kicks off the loading/processing of `local` and `prefetch`
        phones.initialize();

        $('#typeahead_imei').typeahead({
            hint: true,
            highlight: true,
            minLength: 1
        },
        {
            name: 'phones',
            displayKey: 'value',
            // `ttAdapter` wraps the suggestion engine in an adapter that
            // is compatible with the typeahead jQuery plugin
            source: phones.ttAdapter()
        });

        $('#typeahead_imei').on('typeahead:selected', function (e, data) {    
            addMoreThanOne = false;
            if ($('#tagsChosen').attr('value').indexOf(data.value ) < 0)      {      
                if (addMoreThanOne)
                    $('#tagsChosen').addTag(data.value);            
                else if (tagsNum == 0){
                       $('#tagsChosen').addTag(data.value); 
                   } else
                       $.notific8('You can\'t add more than one phone when the distribution status is Offline.',
                   {
                       life: 5000,
                       theme: "lemon",
                         icon: 'check-mark-2',
  sticky: false,
  horizontalEdge: 'bottom',
  verticalEdge: 'right',
  zindex: 9999
                   });                     
            }
        });
    }
</script>
